(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{8092:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,3275,23)),Promise.resolve().then(t.bind(t,9630))},9630:(e,r,t)=>{"use strict";t.d(r,{AuthProvider:()=>o,a:()=>l});var s=t(7437),n=t(2265),i=t(4282);let a=(0,n.createContext)(void 0);function o(e){let{children:r}=e,[t,o]=(0,n.useState)(null),[l,u]=(0,n.useState)(!0),c=()=>{o((0,i.ts)())};return(0,n.useEffect)(()=>{c(),u(!1)},[]),(0,s.jsx)(a.Provider,{value:{user:t,loading:l,isLoggedIn:(0,i.$8)(),logout:()=>{(0,i.kS)(),o(null)},refreshUser:c},children:r})}function l(){let e=(0,n.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4282:(e,r,t)=>{"use strict";t.d(r,{$8:()=>f,GJ:()=>S,h8:()=>I,kS:()=>y,lP:()=>T,pH:()=>m,r4:()=>d,rd:()=>b,sD:()=>A,ts:()=>w});let s=async e=>{let r=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",r))).map(e=>e.toString(16).padStart(2,"0")).join("")},n=async(e,r)=>await s(e)===r,i=()=>"user_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),a="ngventures_users",o="ngventures_session",l=()=>{let e=localStorage.getItem(a);return e?JSON.parse(e):[]},u=e=>{localStorage.setItem(a,JSON.stringify(e))},c=e=>l().find(r=>r.email.toLowerCase()===e.toLowerCase())||null,d=async(e,r,t,n,a)=>{try{if(c(e))return{success:!1,error:"User with this email already exists"};if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return{success:!1,error:"Invalid email format"};if(r.length<6)return{success:!1,error:"Password must be at least 6 characters"};let o=await s(r),d={id:i(),email:e.toLowerCase(),name:t,phone:a,userType:n,passwordHash:o,createdAt:new Date().toISOString(),onboardingComplete:"admin"===n,subscriptionTier:"admin"===n?"enterprise":"free",isAdmin:"admin"===n},m=l();m.push(d),u(m);let{passwordHash:g,...h}=d;return{success:!0,user:d}}catch(e){return console.error("Error creating user:",e),{success:!1,error:"Failed to create user"}}},m=async(e,r)=>{try{let t=c(e);if(!t||!await n(r,t.passwordHash))return{success:!1,error:"Invalid email or password"};return g(t),{success:!0,user:t}}catch(e){return console.error("Error logging in:",e),{success:!1,error:"Failed to login"}}},g=e=>{let r={userId:e.id,email:e.email,userType:e.userType,name:e.name,isAdmin:e.isAdmin||"admin"===e.userType,timestamp:Date.now()};localStorage.setItem(o,JSON.stringify(r))},h=()=>{let e=localStorage.getItem(o);if(!e)return null;let r=JSON.parse(e);return Date.now()-r.timestamp>864e5?(p(),null):r},p=()=>{localStorage.removeItem(o)},f=()=>null!==h(),w=()=>{let e=h();return e?c(e.email):null},y=()=>{p()},S=e=>(null==e?void 0:e.userType)==="admin"||(null==e?void 0:e.isAdmin)===!0,v=()=>S(w()),b=async()=>{let e="admin@ngventures.com";c(e)||(await d(e,"admin123","System Administrator","admin"),console.log("âœ… Default admin account created: admin@ngventures.com / admin123"))},A=()=>v()?l():(console.error("Unauthorized: Admin access required"),[]),T=()=>{if(!v())return console.error("Unauthorized: Admin access required"),null;let e=l();return{total:e.length,admins:e.filter(e=>"admin"===e.userType).length,brands:e.filter(e=>"brand"===e.userType).length,owners:e.filter(e=>"owner"===e.userType).length,freeUsers:e.filter(e=>"free"===e.subscriptionTier).length,premiumUsers:e.filter(e=>"premium"===e.subscriptionTier).length,enterpriseUsers:e.filter(e=>"enterprise"===e.subscriptionTier).length}},I=e=>{if(!v())return console.error("Unauthorized: Admin access required"),!1;try{let r=l(),t=r.filter(r=>r.id!==e);if(r.length===t.length)return!1;return u(t),!0}catch(e){return console.error("Error deleting user:",e),!1}}},3275:()=>{}},e=>{var r=r=>e(e.s=r);e.O(0,[757,130,215,744],()=>r(8092)),_N_E=e.O()}]);